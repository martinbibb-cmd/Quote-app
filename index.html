<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Hydronic Quote Builder</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="app-header">
    <div>
      <h1>Hydronic Quote Builder</h1>
      <p class="subtitle">Guided survey and quote assembly using the live price book</p>
    </div>
    <nav class="step-nav" aria-label="Quote steps">
      <button class="step-link active" data-step="project">1. Project</button>
      <button class="step-link" data-step="layout">2. Locations</button>
      <button class="step-link" data-step="systems">3. Systems</button>
      <button class="step-link" data-step="components">4. Components</button>
      <button class="step-link" data-step="summary">5. Summary</button>
    </nav>
  </header>

  <main>
    <section id="step-project" class="step-panel active" aria-labelledby="step-project-title">
      <h2 id="step-project-title">Project briefing</h2>
      <div class="grid grid-3">
        <article class="card">
          <h3>Customer</h3>
          <label class="stack">
            <span>Select customer <span class="required">(required)</span></span>
            <select id="customer-select" required></select>
          </label>
          <dl id="customer-details" class="meta"></dl>
        </article>

        <article class="card" id="existing-boiler-card">
          <h3>Present system <span class="required">(required)</span></h3>
          <p class="muted">Choose the boiler type currently installed. This selects Base Pack A.</p>
          <div id="boiler-type-grid" class="type-grid" role="list"></div>
        </article>

        <article class="card">
          <h3>Site measurements</h3>
          <p class="muted">Enter available space for the new appliance (mm).</p>
          <div class="grid grid-3 tight">
            <label class="stack"><span>Height</span><input type="number" id="measure-height" min="0" placeholder="H"></label>
            <label class="stack"><span>Width</span><input type="number" id="measure-width" min="0" placeholder="W"></label>
            <label class="stack"><span>Depth</span><input type="number" id="measure-depth" min="0" placeholder="D"></label>
          </div>
          <label class="stack mt">
            <span>Other measurement notes</span>
            <textarea id="measure-notes" rows="3" placeholder="E.g., restricted cupboard access"></textarea>
          </label>
        </article>
      </div>

      <div class="grid grid-2 mt">
        <article class="card">
          <div class="section-heading">
            <h3>Photos</h3>
            <button id="add-photo" class="ghost small">Add photo prompt</button>
          </div>
          <ul id="photo-list" class="checklist" aria-live="polite"></ul>
        </article>
        <article class="card">
          <div class="section-heading">
            <h3>Observations</h3>
            <button id="add-observation" class="ghost small">Add observation</button>
          </div>
          <ul id="observation-list" class="checklist" aria-live="polite"></ul>
        </article>
      </div>

      <article class="card mt" id="new-system-card">
        <h3>New system selection <span class="required">(required)</span></h3>
        <p class="muted">This selects Pack B and drives boiler and controls availability.</p>
        <div id="system-options" class="system-options"></div>
      </article>
    </section>

    <section id="step-layout" class="step-panel" aria-labelledby="step-layout-title">
      <h2 id="step-layout-title">House layout</h2>
      <div class="grid grid-2">
        <article class="card house-panel">
          <h3>Current boiler location</h3>
          <p class="muted">Tap a room to map the existing system.</p>
          <div id="current-rooms" class="house-grid" role="radiogroup"></div>
        </article>
        <article class="card house-panel">
          <h3>New plant location</h3>
          <p class="muted">Tap a room to map the proposed install. Adds to base pack.</p>
          <div id="new-rooms" class="house-grid" role="radiogroup"></div>
        </article>
      </div>
      <article class="card mt">
        <h3>Location notes</h3>
        <textarea id="location-notes" rows="4" placeholder="Record access routes, lifting requirements, scaffolding, earthing, pressures, WAH, safety notes"></textarea>
      </article>
    </section>

    <section id="step-systems" class="step-panel" aria-labelledby="step-systems-title">
      <h2 id="step-systems-title">Boiler, flue, gas &amp; condensate</h2>
      <div class="grid grid-3">
        <article class="card">
          <h3>Boiler selection <span class="required">(required)</span></h3>
          <div id="boiler-options" class="option-stack" aria-live="polite"></div>
        </article>
        <article class="card">
          <h3>Clearance check</h3>
          <p class="muted">Validate measured space against the chosen boiler and manufacturer clearance guidance.</p>
          <button id="check-clearances" class="primary full">Validate measurements</button>
          <div id="clearance-report" class="report"></div>
          <div class="clearance-image" id="clearance-image" aria-hidden="true"></div>
        </article>
        <article class="card">
          <h3>Boiler working memory</h3>
          <ul id="working-memory" class="memory-list"></ul>
        </article>
      </div>

      <div class="grid grid-2 mt">
        <article class="card">
          <h3>Flue configuration <span class="required">(required)</span></h3>
          <div id="flue-tabs" class="tabs"></div>
          <div id="flue-variants" class="option-stack"></div>
          <div class="heatmap" id="flue-heatmap"></div>
        </article>
        <article class="card">
          <h3>Gas &amp; condensate</h3>
          <div>
            <h4>Gas options</h4>
            <div id="gas-options" class="option-stack"></div>
          </div>
          <div class="mt">
            <h4>Condensate options</h4>
            <div id="condensate-options" class="option-stack"></div>
          </div>
        </article>
      </div>
    </section>

    <section id="step-components" class="step-panel" aria-labelledby="step-components-title">
      <h2 id="step-components-title">System components &amp; services</h2>
      <div class="grid grid-2">
        <article class="card">
          <h3>House system map</h3>
          <p class="muted">Select the hotspots to add cylinders, controls, user interfaces, radiators, valves, tanks, add-ons and services. Drill down to tweak quantities.</p>
          <div id="component-map" class="component-map" role="list"></div>
        </article>
        <article class="card">
          <h3 id="component-detail-title">Component detail</h3>
          <div id="component-detail" class="option-stack"></div>
        </article>
      </div>
    </section>

    <section id="step-summary" class="step-panel" aria-labelledby="step-summary-title">
      <h2 id="step-summary-title">Quote summary</h2>
      <div class="grid grid-3">
        <article class="card">
          <h3>Packs &amp; products</h3>
          <ul id="quote-lines" class="memory-list"></ul>
        </article>
        <article class="card">
          <h3>Skill hours</h3>
          <p class="muted">Built automatically from packs and selected products.</p>
          <dl id="hours-breakdown" class="meta"></dl>
          <div class="total">
            <span>Total hours</span>
            <strong id="total-hours">0</strong>
          </div>
        </article>
        <article class="card">
          <h3>Costing</h3>
          <dl id="cost-breakdown" class="meta"></dl>
          <div class="total">
            <span>Total (parts only)</span>
            <strong id="total-parts">£0.00</strong>
          </div>
          <div class="total">
            <span>Labour @ £<span id="labour-rate">0</span>/hr</span>
            <strong id="total-labour">£0.00</strong>
          </div>
          <div class="grand-total">
            <span>Grand total</span>
            <strong id="grand-total">£0.00</strong>
          </div>
        </article>
      </div>

      <div class="grid grid-2 mt">
        <article class="card">
          <h3>Customer presentation</h3>
          <textarea id="customer-presentation" rows="10" class="mono"></textarea>
          <button id="copy-presentation" class="ghost small">Copy presentation</button>
        </article>
        <article class="card">
          <h3>Installation notes</h3>
          <textarea id="installation-notes" rows="10" class="mono"></textarea>
          <button id="copy-notes" class="ghost small">Copy notes</button>
        </article>
      </div>

      <div class="actions">
        <button id="submit-quote" class="primary">Submit to quote</button>
        <span id="submit-status" role="status" class="muted"></span>
      </div>
      <article class="card mt">
        <h3>Quote JSON</h3>
        <textarea id="quote-json" rows="8" class="mono"></textarea>
      </article>
    </section>
  </main>

  <footer class="app-footer">
    <small>All data sourced from Data/price-book.json. Selections are stored in browser memory only.</small>
  </footer>

  <template id="component-template">
    <div class="component-item">
      <div class="component-info">
        <h4></h4>
        <p class="muted"></p>
      </div>
      <div class="component-actions">
        <label>Qty
          <input type="number" min="0" step="1" value="0">
        </label>
      </div>
    </div>
  </template>

  <script src="app.js"></script>
</body>
</html>
